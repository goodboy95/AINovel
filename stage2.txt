现在我们开始小说生成器第二期的设计，在这一阶段需要进行一些优化，我现在能想到的优化点如下：
1、“故事构思”阶段让大模型生成比较长的故事梗概，同时让大模型综合考虑角色关系，多生成一些角色卡。除此之外，在故事卡中保存类型和基调时，要使用简体中文。
2、生成大纲时，除了设定章数之外，也要允许用户设定每章的节数，每节的大概字数。
3、生成出的大纲中，对于每节的内容而言，除了包括该节的故事梗概之外，还要包含该节的所有出场人物，人物在这一节的状态，想法，行动等信息。且每一节的故事梗概应当更加的充分完整。
4、在进行了上述修改之后，大纲的内容会比较长，因此可以改成“每次生成一章的所有小节大纲内容时，就调一次接口”，有多少章就调多少次接口。调用接口时，要把故事卡的总体故事梗概，上一章的大纲内容（生成第一章内容时可以忽略）发给大模型。
5、在“故事创作”阶段，每次生成一节的故事内容时，要进行以下操作：
（1）用大模型概括上一章的内容（如有）以及本章上一节的内容（如有）。
（2）要将故事卡的故事类型与基调，该节的大纲故事梗概，出场角色详细信息（包括角色卡中的信息，以及大纲中角色的状态，想法，行动等信息），上一章的概括内容（如有），本章上一节的内容（如有）发给大模型，让大模型综合这些信息，生成本节的故事具体内容。
6、在调用大模型，或者向数据库存储数据时，要有重试机制，调用失败后进行重试，重试3次未成功再返回错误。
7、“故事创作”tab中，左侧的大纲浏览区域比较丑。在完成上述6点的优化之后，需要结合实际情况，对左侧的大纲浏览区域进行美化，使其对一般人而言更加易用。具体美化方式可以自行设计。

同时有一个要求：在具体写代码时，要保证代码易读易懂，有必要的注释，让刚接触的人也容易上手。

首先需要综合现在已有的代码，以及上述要求的第二期优化点，设计出一套完整详尽的第二期开发方案，写到dev2.md当中，然后再根据这个开发方案进行具体的开发工作。
如果需要参考初期的开发方案，可参见dev1.md。