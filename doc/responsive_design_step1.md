# 响应式改造 Step 1 —— 基础设施与基础页面

## 1. 背景与目标

前端当前以桌面端布局为主，`#root` 宽度锁定在 1280px，且缺乏统一的断点定义，导致在 1024px 以下设备上出现横向滚动、字体过大、交互拥挤等问题。本阶段旨在搭建一套可复用的响应式基础设施，并率先在曝光度最高、逻辑较简单的页面（首页、登录、注册）验证方案可行性，为后续复杂模块改造铺路。

### 1.1 目标拆解

- 建立统一的断点体系（`xs/sm/md/lg/xl`），并在 Tailwind 与 Ant Design 中同步生效。
- 提供通用的 `useResponsive` Hook 与 `AppShell` 布局容器，供后续阶段复用。
- 调整全局样式，移除固定宽度与冗余内联样式，实现 Content 区域自适应。
- 完成首页、登录页、注册页的响应式布局设计与实现方案，包括移动端/桌面端的视觉与交互细节。
- 输出可落地的测试计划与验收标准。

## 2. 范围界定

| 分类 | 具体内容 | 说明 |
| --- | --- | --- |
| 代码结构 | `tailwind.config.js`、`src/index.css`、`App.css`、`src/styles/responsive.css` *(新增)* | 断点与基础样式的改造范围 |
| 组件/Hooks | `src/hooks/useResponsive.ts` *(新增)*、`App.tsx`、`Layout` 容器 | 建立统一的响应式判断与布局容器 |
| 页面 | `HomePage`、`Login`、`Register` | 包含 UI 排版与交互细节调整 |
| 文档/资产 | 线框稿、动效描述、组件库新增规范 | 供设计与开发协同使用 |

## 3. 需求与体验细化

### 3.1 断点定义与应用规则

| 断点 | 宽度范围 | 全局字号 | 页面边距 | 备注 |
| --- | --- | --- | --- | --- |
| `xs` | `< 576px` | 基础字号 14px，标题最大 24px | 全局内边距 16px，主要按钮占满宽度 | 移动端主体验 |
| `sm` | `576-767px` | 基础字号 15px，标题最大 28px | 内边距 20px | 兼容大屏手机/小平板 |
| `md` | `768-991px` | 基础字号 15px，标题最大 32px | 内边距 24px | 适配横屏平板，小型笔记本 |
| `lg` | `992-1439px` | 基础字号 16px，标题最大 36px | 内容最大宽度 1200px | 主流 PC |
| `xl` | `>=1440px` | 基础字号 16px，标题最大 40px | 内容最大宽度 1360px | 宽屏，提升留白 |

Tailwind `screens`、Antd `Grid`、`AppShell` 将共享该配置，避免多套判定逻辑。

### 3.2 页面层级与布局

- **首页**：
  - PC 端保持左右居中布局，但标题字号随断点缩放，按钮组在 `sm` 以下改为纵向堆叠。
  - 移动端顶部加入渐变背景与产品亮点的卡片式展示，每个卡片采用 100% 宽度、16px 圆角。
- **登录/注册**：
  - `Card` 宽度调整为 `min(100%, 360px)`，并通过 `AppShell` 居中。
  - 额外链接（忘记密码、切换注册）在移动端放置于卡片底部的 `Stack` 中，保证触达；PC 端保持现有布局。
  - 表单项之间间距在 `xs` 时缩减至 16px，`lg` 时恢复 24px。
- **导航与页脚**：
  - 首页顶部导航在移动端改为折叠按钮，展开后以 Drawer 呈现，优先展示「登录 / 注册」。
  - 页脚采用两栏布局，`xs` 时改为单列堆叠。

## 4. 技术方案

### 4.1 Tailwind 与全局样式

1. **扩展断点**：在 `tailwind.config.js` 中定义 `screens`，同时补充常用 spacing、fontSize 变量。
2. **抽离公共媒体查询**：新增 `src/styles/responsive.css`，包含体量较大的媒体查询（如背景图、复杂布局）并在 `main.tsx` 中引入。
3. **根节点样式调整**：
   - `App.css` 移除 `#root` 固定宽度与居中，改由 `body` 设置背景与最小高度。
   - 定义 `.app-shell` 类作为全局容器，设置 `max-width`、`margin: 0 auto`、断点内边距等。

### 4.2 `useResponsive` Hook 与 `AppShell`

- `useResponsive` 封装 Antd `Grid.useBreakpoint()`，返回：
  - `isMobile`（`xs`/`sm`）、`isTablet`（`md`）、`isDesktop`（`lg` 及以上）
  - 当前断点字符串 `activeBreakpoint`
  - 常用工具函数 `up(breakpoint)` / `down(breakpoint)`
- `AppShell` 组件负责：
  - 包裹顶层路由内容，注入 `className` 与 `style` 以控制最大宽度/背景色。
  - 根据断点切换页边距与滚动行为，例如 `xs` 下启用 `min-height: 100vh` + `padding-bottom`。
  - 提供 `header`、`footer` slot（通过 props 或 children）以便后续阶段复用。

### 4.3 页面改造要点

1. **首页**：
   - 使用 Tailwind 响应式类控制字体与间距，例如 `text-4xl lg:text-5xl`、`space-y-6 sm:space-y-8`。
   - 按钮组件引入 `block w-full sm:w-auto` 以支持手机全宽展示。
   - 移动端额外区块（亮点卡片）可抽象为 `FeatureCard` 组件，为后续营销模块复用打基础。
2. **登录/注册**：
   - 采用 `Flex` + `AppShell` 实现垂直居中，避免绝对定位。
   - 表单内部利用 Antd `Form` 的 `layout="vertical"`，并通过 `Form.Item` 自定义 `style` 控制间距。
   - 搭配 `useResponsive` 在移动端隐藏背景插图，减少加载体积。
3. **导航 Drawer**：
   - 新增 `HeaderNav` 组件，`lg` 以上展示完整菜单，`md` 以下展示汉堡按钮。
   - Drawer 打开时禁用背景滚动，按钮顺序优先呈现账号操作。

## 5. 实施步骤与排期建议

1. **准备 (1 人日)**
   - 评估现有样式与 Tailwind 配置，梳理将被删除/替换的样式。
   - 与设计确认移动端线框、按钮尺寸、字体层级。
2. **基础设施搭建 (1.5 人日)**
   - 修改 Tailwind 配置并引入 `responsive.css`。
   - 实现 `useResponsive`、`AppShell`，并在 `App.tsx` 中落地。
3. **页面适配 (1.5 人日)**
   - 首页组件重构排版。
   - 登录/注册页面移除固定宽度，加入 Drawer 导航。
4. **联调与回归 (0.5 人日)**
   - 手动验证主流断点。
   - 更新开发文档、截图。

## 6. 风险与应对

| 风险 | 描述 | 缓解措施 |
| --- | --- | --- |
| 断点冲突 | Tailwind 与 Antd 断点命名重叠但数值不同 | 在 Step 1 确认统一配置，并编写文档提醒后续使用方式 |
| 全局样式影响现有模块 | `AppShell` 引入后可能影响尚未改造的页面 | 默认保持旧布局必要的样式（如最小宽度），并通过临时 `legacy-layout` 类兼容 |
| Drawer 引入导致路由状态异常 | 新增导航 Drawer 需确认与路由跳转兼容 | 在实现阶段编写 E2E 或手动脚本验证打开/关闭流程 |

## 7. 验收标准与测试计划

1. **功能验收**
   - 首页、登录、注册页面在 375px、414px、768px、1280px、1440px 下无横向滚动条。
   - 移动端按钮触控区域 ≥ 48px，高度符合规范。
   - Drawer 在 iOS/Android 浏览器中可正常滚动、关闭。
2. **兼容性验收**
   - Chrome、Safari、Edge 最新版本；安卓 Chrome；iOS Safari。
   - 页面首屏渲染无明显样式闪烁。
3. **测试清单**
   - 单元测试：`useResponsive` 返回值覆盖断点边界。
   - 视觉回归：与设计输出移动端与桌面端截图比对。
   - 可访问性：检查语义标签（主按钮需有 `aria-label`）。

完成上述标准后，即可启动 Step 2。
